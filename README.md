# Цифровой Прорыв 2024 (УрФО)

*ГНУ МИСИС team*

Team Members:
1) **Груздев Александр** - ML Engineer
2) **Рыжичкин Кирилл** - ML Engineer, Backend
3) **Миронов Егор** - Frontend, Backend
4) **Москвин Владимир** - Product Manager

Презентация: [link](https://drive.google.com/)

## Задача трека "Креативный фильтр"

На основе имеющихся данных и разметки необходимо разработать модель, которая предсказывает то, к какому сегменту (*Segment_num*) относится заданный креатив (*Advertisement ID*). При разработке решения не забывайте про отраслевые критерии.

## Данные:

1. Папка **data** - различные рекламные креативы следующих форматов: .wav, .mp4, .avi, .flv, .wbm, .ogg. Каждый файл носит название, соответствующее Advertisement ID - уникальный идентификатор рекламного креатива.
2. Файл **train_segments.csv** - сопоставления идентификаторам номеров сегментов.
3. Файл **segment_dict.xlsx** - словарь, отображающий номер сегмента в его название.
4. Файл **dashboard_data.csv** - информация по затратам на различные креативы по месяцам для использования при визуализации дашбордов. На один месяц может приходиться более одной строки с уникальным идентификатором - в таком случае затраты необходимо просуммировать.

## Предложенное решение

![pipe](scheme.png)

**API**: http://gnu.itatmisis.ru:8000/docs#/
- /predict/: принимает видео или аудио на вход - возвращает класс
- /predict_table/: принимает xlsx таблицу с advertisment id - возвращает аналогичную таблицу с предсказанными классами для каждого id

**Сделано**: 

- классификация рекламы по аудио-составляющей, пайплайн: rus --> audio2text (whisper-small) --> rubert-tiny --> label (~1s)
- классификация рекламы по видео-составляющей, пайплайн: rus --> x-clip features extraction --> cosine similarity/catboost --> label (~2s)

**Метрики на тесте**: 

**Аудио**:
- precision: 0.7452538178050809
- recall: 0.7289481034579074
- f1score_macro: 0.7184429627435494

**Видео**: 
- f1score_macro: 0.42182361938447205 (xclip features + cosine similarity)
- f1score_macro: 0.41438178427412037 (xclip features + catboost)
